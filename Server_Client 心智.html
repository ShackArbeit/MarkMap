<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"Next.js Server / Client Components&#xff08;&#x91cd;&#x9ede;&#x8907;&#x7fd2;&#x7248;&#xff09;","children":[{"content":"1) &#x9810;&#x8a2d;&#x898f;&#x5247;","children":[{"content":"<code>layout.tsx</code> / <code>page.tsx</code> <strong>&#x9810;&#x8a2d;&#x662f; Server Components</strong>","children":[],"payload":{"tag":"li","lines":"8,9"}},{"content":"&#x9700;&#x8981;&#x4e92;&#x52d5;&#x6216;&#x700f;&#x89bd;&#x5668; API &#x624d;&#x4f7f;&#x7528; <strong>Client Components&#xff08;&apos;use client&apos;&#xff09;</strong>","children":[],"payload":{"tag":"li","lines":"9,11"}}],"payload":{"tag":"h2","lines":"7,8"}},{"content":"2) &#x4ec0;&#x9ebc;&#x6642;&#x5019;&#x7528; Client Components&#xff1f;","children":[{"content":"&#x72c0;&#x614b; / &#x4e8b;&#x4ef6;&#xff1a;<code>useState</code>, <code>onClick</code>, <code>onChange</code>","children":[],"payload":{"tag":"li","lines":"15,16"}},{"content":"Lifecycle&#xff1a;<code>useEffect</code>","children":[],"payload":{"tag":"li","lines":"16,17"}},{"content":"Browser APIs&#xff1a;<code>window</code>, <code>localStorage</code>, <code>geolocation</code>...","children":[],"payload":{"tag":"li","lines":"17,18"}},{"content":"&#x81ea;&#x8a02; hooks","children":[],"payload":{"tag":"li","lines":"18,19"}},{"content":"React Context Provider&#xff08;context &#x4e0d;&#x652f;&#x63f4;&#x5728; Server Components &#x5167;&#x5ba3;&#x544a;/&#x4f7f;&#x7528;&#xff09;","children":[],"payload":{"tag":"li","lines":"19,21"}}],"payload":{"tag":"h2","lines":"13,14"}},{"content":"3) &#x4ec0;&#x9ebc;&#x6642;&#x5019;&#x7528; Server Components&#xff1f;","children":[{"content":"&#x8cc7;&#x6599;&#x6293;&#x53d6;&#xff08;DB / API&#xff09;&#x9760;&#x8fd1;&#x8cc7;&#x6599;&#x6e90;","children":[],"payload":{"tag":"li","lines":"25,26"}},{"content":"&#x4f7f;&#x7528; <strong>secrets</strong>&#xff08;API key / token&#xff09;&#x4e0d;&#x66b4;&#x9732;&#x5230; client","children":[],"payload":{"tag":"li","lines":"26,27"}},{"content":"&#x6e1b;&#x5c11;&#x9001;&#x5230;&#x700f;&#x89bd;&#x5668;&#x7684; JS","children":[],"payload":{"tag":"li","lines":"27,28"}},{"content":"&#x63d0;&#x5347; FCP&#x3001;&#x652f;&#x63f4; Streaming&#xff08;&#x642d;&#x914d; Suspense&#xff09;","children":[],"payload":{"tag":"li","lines":"28,30"}}],"payload":{"tag":"h2","lines":"23,24"}},{"content":"4) &apos;use client&apos; &#x7684;&#x91cd;&#x8981;&#x6982;&#x5ff5;&#xff08;Client boundary&#xff09;","children":[{"content":"&#x5728;&#x6a94;&#x6848;&#x9802;&#x90e8;&#x52a0; <code>&apos;use client&apos;</code> &#x4ee3;&#x8868;&#x5efa;&#x7acb; <strong>Server/Client &#x5206;&#x754c;</strong>","children":[],"payload":{"tag":"li","lines":"33,34"}},{"content":"&#x9019;&#x500b;&#x6a94;&#x6848;&#x7684;&#xff1a;","children":[{"content":"imports","children":[],"payload":{"tag":"li","lines":"35,36"}},{"content":"children<br>\n&#x90fd;&#x6703;&#x88ab;&#x6253;&#x9032; <strong>client bundle</strong>","children":[],"payload":{"tag":"li","lines":"36,38"}}],"payload":{"tag":"li","lines":"34,38"}},{"content":"&#x6700;&#x4f73;&#x5be6;&#x52d9;&#xff1a;&#x53ea;&#x628a;&#x300c;&#x771f;&#x7684;&#x9700;&#x8981;&#x4e92;&#x52d5;&#x300d;&#x7684;&#x5143;&#x4ef6;&#x6a19;&#x6210; client&#xff0c;&#x907f;&#x514d; bundle &#x8b8a;&#x5927;","children":[],"payload":{"tag":"li","lines":"38,40"}}],"payload":{"tag":"h2","lines":"32,33"}},{"content":"5) Server / Client &#x7684;&#x6e32;&#x67d3;&#x6d41;&#x7a0b;&#xff08;&#x5fc5;&#x80cc;&#xff09;","children":[{"content":"Server &#x7aef;","children":[{"content":"Server Components &#x2192; &#x7522;&#x751f; <strong>RSC Payload</strong>","children":[],"payload":{"tag":"li","lines":"44,45"}},{"content":"Client Components + RSC Payload &#x2192; &#x7528;&#x4f86; <strong>&#x9810;&#x6e32;&#x67d3; HTML</strong>","children":[],"payload":{"tag":"li","lines":"45,47"}}],"payload":{"tag":"h3","lines":"43,44"}},{"content":"Client &#x7b2c;&#x4e00;&#x6b21;&#x8f09;&#x5165;","children":[{"content":"HTML&#xff1a;&#x5148;&#x986f;&#x793a;&#x300c;&#x5feb;&#x901f;&#x4f46;&#x4e0d;&#x53ef;&#x4e92;&#x52d5;&#x300d;&#x7684;&#x756b;&#x9762;","children":[],"payload":{"tag":"li","lines":"48,49"}},{"content":"RSC Payload&#xff1a;&#x5c0d;&#x9f4a; server/client component tree","children":[],"payload":{"tag":"li","lines":"49,50"}},{"content":"JS&#xff1a;Hydrate Client Components &#x2192; &#x8b8a;&#x53ef;&#x4e92;&#x52d5;","children":[],"payload":{"tag":"li","lines":"50,52"}}],"payload":{"tag":"h3","lines":"47,48"}},{"content":"&#x5f8c;&#x7e8c;&#x5c0e;&#x822a;&#xff08;client-side navigation&#xff09;","children":[{"content":"RSC Payload &#x6703;&#x88ab; prefetch + cache","children":[],"payload":{"tag":"li","lines":"55,56"}},{"content":"Client Components &#x5728; client &#x7aef;&#x6e32;&#x67d3;&#xff08;&#x4e0d;&#x518d;&#x4f9d;&#x8cf4; server-rendered HTML&#xff09;","children":[],"payload":{"tag":"li","lines":"56,58"}}],"payload":{"tag":"h3","lines":"54,55"}}],"payload":{"tag":"h2","lines":"42,43"}},{"content":"6) Server &#x2192; Client &#x50b3;&#x8cc7;&#x6599;&#xff08;Props&#xff09;","children":[{"content":"Server Component &#x6293;&#x8cc7;&#x6599;&#x5f8c;&#xff0c;&#x7528; props &#x50b3;&#x7d66; Client Component","children":[],"payload":{"tag":"li","lines":"61,62"}},{"content":"&#x6ce8;&#x610f;&#xff1a;&#x50b3;&#x7d66; Client &#x7684; props &#x5fc5;&#x9808; <strong>&#x53ef;&#x5e8f;&#x5217;&#x5316;&#xff08;serializable&#xff09;</strong>","children":[],"payload":{"tag":"li","lines":"62,63"}},{"content":"&#x9032;&#x968e;&#xff1a;&#x4e5f;&#x53ef;&#x7528; React <code>use()</code> + Suspense &#x4f86;&#x300c;&#x4e32;&#x6d41;&#x300d;promise&#xff08;&#x7565;&#xff09;","children":[],"payload":{"tag":"li","lines":"63,65"}}],"payload":{"tag":"h2","lines":"60,61"}},{"content":"7) &#x4ea4;&#x932f;&#x7d44;&#x5408;&#xff08;Interleaving&#xff09;","children":[{"content":"Client Component &#x53ef;&#x4ee5;&#x63a5;&#x6536; <strong>Server Component &#x7576; children</strong>","children":[],"payload":{"tag":"li","lines":"68,69"}},{"content":"&#x5e38;&#x898b; pattern&#xff1a;","children":[{"content":"Client&#xff1a;&#x63a7;&#x5236; UI &#x72c0;&#x614b;&#xff08;Modal &#x958b;&#x95dc;&#xff09;","children":[],"payload":{"tag":"li","lines":"70,71"}},{"content":"Server&#xff1a;&#x653e;&#x8cc7;&#x6599;&#x6293;&#x53d6;&#x5143;&#x4ef6;&#xff08;Cart&#xff09;","children":[],"payload":{"tag":"li","lines":"71,73"}}],"payload":{"tag":"li","lines":"69,73"}}],"payload":{"tag":"h2","lines":"67,68"}},{"content":"8) Context Provider&#xff08;&#x5fc5;&#x8003;&#x9ede;&#xff09;","children":[{"content":"React context <strong>&#x4e0d;&#x652f;&#x63f4;&#x5728; Server Components &#x5167;&#x4f7f;&#x7528;</strong>","children":[],"payload":{"tag":"li","lines":"76,77"}},{"content":"&#x89e3;&#x6cd5;&#xff1a;","children":[{"content":"&#x5efa;&#x7acb; Client Provider&#xff08;<code>&apos;use client&apos;</code>&#xff09;","children":[],"payload":{"tag":"li","lines":"78,79"}},{"content":"&#x5728; Server &#x7684; layout/page &#x628a; Provider &#x5305;&#x4f4f; children","children":[],"payload":{"tag":"li","lines":"79,80"}}],"payload":{"tag":"li","lines":"77,80"}},{"content":"&#x6700;&#x4f73;&#x5be6;&#x52d9;&#xff1a;Provider &#x76e1;&#x91cf; <strong>&#x5305;&#x6df1;&#x4e00;&#x9ede;</strong>&#xff08;&#x4e0d;&#x8981;&#x5305;&#x6574;&#x500b; <code>&lt;html&gt;</code>&#xff09;&#xff0c;&#x8b93;&#x975c;&#x614b;&#x90e8;&#x5206;&#x66f4;&#x597d;&#x88ab;&#x6700;&#x4f73;&#x5316;","children":[],"payload":{"tag":"li","lines":"80,82"}}],"payload":{"tag":"h2","lines":"75,76"}},{"content":"9) &#x5171;&#x7528;&#x8cc7;&#x6599;&#xff1a;React.cache + Context&#xff08;&#x91cd;&#x9ede;&#x89c0;&#x5ff5;&#xff09;","children":[{"content":"Server&#xff1a;&#x7528; <code>React.cache()</code> &#x5305;&#x8cc7;&#x6599;&#x53d6;&#x5f97;&#x51fd;&#x5f0f;&#xff08;&#x540c;&#x4e00; request &#x5167;&#x53bb;&#x91cd;&#xff09;","children":[],"payload":{"tag":"li","lines":"85,86"}},{"content":"Layout&#xff1a;&#x5148;&#x62ff;&#x5230; promise&#xff08;&#x4e0d;&#x8981; await&#xff09;&#x4e1f;&#x9032; Client Provider","children":[],"payload":{"tag":"li","lines":"86,87"}},{"content":"Client&#xff1a;&#x5f9e; context &#x62ff; promise&#xff0c;&#x7528; <code>use()</code> &#x89e3;&#x6790;&#xff08;&#x642d;&#x914d; Suspense&#xff09;","children":[],"payload":{"tag":"li","lines":"87,88"}},{"content":"&#x6ce8;&#x610f;&#xff1a;<code>React.cache</code> &#x53ea;&#x5728; <strong>&#x540c;&#x4e00;&#x6b21; request</strong> &#x7bc4;&#x570d;&#x6709;&#x6548;&#xff08;&#x4e0d;&#x8de8; request&#xff09;","children":[],"payload":{"tag":"li","lines":"88,90"}}],"payload":{"tag":"h2","lines":"84,85"}},{"content":"10) &#x7b2c;&#x4e09;&#x65b9;&#x5143;&#x4ef6;&#xff08;library &#x6c92;&#x5beb; &apos;use client&apos;&#xff09;","children":[{"content":"&#x82e5;&#x7b2c;&#x4e09;&#x65b9;&#x5143;&#x4ef6;&#x5176;&#x5be6;&#x7528;&#x5230; client-only features&#xff08;useState &#x7b49;&#xff09;&#xff1a;","children":[{"content":"&#x7528;&#x4f60;&#x81ea;&#x5df1;&#x7684; Client wrapper &#x5305;&#x8d77;&#x4f86;&#xff08;&#x52a0; <code>&apos;use client&apos;</code>&#xff09;","children":[],"payload":{"tag":"li","lines":"94,95"}},{"content":"&#x4e4b;&#x5f8c; Server Component &#x5c31;&#x80fd;&#x5b89;&#x5168;&#x4f7f;&#x7528;&#x8a72; wrapper","children":[],"payload":{"tag":"li","lines":"95,97"}}],"payload":{"tag":"li","lines":"93,97"}}],"payload":{"tag":"h2","lines":"92,93"}},{"content":"11) &#x9632;&#x6b62;&#x300c;&#x74b0;&#x5883;&#x6c61;&#x67d3;&#x300d;&#xff08;Server-only / Client-only&#xff09;","children":[{"content":"&#x98a8;&#x96aa;&#xff1a;&#x4e0d;&#x5c0f;&#x5fc3;&#x628a; server-only code&#xff08;&#x542b; secrets&#xff09;import &#x5230; client","children":[],"payload":{"tag":"li","lines":"100,101"}},{"content":"&#x4f5c;&#x6cd5;&#xff1a;","children":[{"content":"&#x5728; server-only module &#x9802;&#x90e8;&#x52a0;&#xff1a;<code>import &apos;server-only&apos;</code>","children":[],"payload":{"tag":"li","lines":"102,103"}},{"content":"&#x82e5; client-only module&#xff1a;<code>import &apos;client-only&apos;</code>","children":[],"payload":{"tag":"li","lines":"103,104"}}],"payload":{"tag":"li","lines":"101,104"}},{"content":"&#x6548;&#x679c;&#xff1a;&#x932f;&#x8aa4;&#x74b0;&#x5883; import &#x6703;&#x5728; build-time &#x5831;&#x932f;&#xff08;&#x66f4;&#x5b89;&#x5168;&#xff09;","children":[],"payload":{"tag":"li","lines":"104,106"}}],"payload":{"tag":"h2","lines":"99,100"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
