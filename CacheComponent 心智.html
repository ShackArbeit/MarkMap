<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
              if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.documentElement.classList.add("markmap-dark");
              }
            })(() => window.markmap,null,{"content":"Next.js Cache Components&#xff08;&#x91cd;&#x9ede;&#x901f;&#x8b80;&#x7248;&#xff09;","children":[{"content":"1) &#x4ec0;&#x9ebc;&#x662f; Cache Components&#xff1f;","children":[{"content":"<strong>Opt-in</strong>&#xff1a;<code>next.config.ts</code> &#x2192; <code>cacheComponents: true</code>","children":[],"payload":{"tag":"li","lines":"7,8"}},{"content":"&#x76ee;&#x7684;&#xff1a;&#x540c;&#x4e00;&#x689d; route &#x6df7;&#x5408;","children":[{"content":"<strong>Static&#xff08;&#x5feb;&#xff09;</strong>","children":[],"payload":{"tag":"li","lines":"9,10"}},{"content":"<strong>Cached&#xff08;&#x53ef;&#x5feb;&#x53d6;&#xff09;</strong>","children":[],"payload":{"tag":"li","lines":"10,11"}},{"content":"<strong>Dynamic&#xff08;&#x8acb;&#x6c42;&#x6642;&#x624d;&#x7b97;&#xff09;</strong>","children":[],"payload":{"tag":"li","lines":"11,12"}}],"payload":{"tag":"li","lines":"8,12"}},{"content":"&#x6838;&#x5fc3;&#x6210;&#x679c;&#xff1a;","children":[{"content":"&#x5148;&#x7522;&#x51fa; <strong>Static HTML Shell</strong>&#xff08;&#x79d2;&#x51fa;&#x756b;&#x9762;&#xff09;","children":[],"payload":{"tag":"li","lines":"13,14"}},{"content":"&#x52d5;&#x614b;&#x5340;&#x584a;&#x518d;&#x7528; <strong>Streaming / request time</strong> &#x88dc;&#x4e0a;","children":[],"payload":{"tag":"li","lines":"14,16"}}],"payload":{"tag":"li","lines":"12,16"}}],"payload":{"tag":"h2","lines":"6,7"}},{"content":"2) &#x6e32;&#x67d3;&#x6a21;&#x578b;&#xff1a;Partial Prerendering&#xff08;PPR&#xff09;","children":[{"content":"&#x555f;&#x7528;&#x5f8c;&#x9810;&#x8a2d;&#x5c31;&#x662f; <strong>PPR</strong>","children":[],"payload":{"tag":"li","lines":"19,20"}},{"content":"Build time &#x5148; prerender&#xff1a;","children":[{"content":"&#x80fd;&#x5b8c;&#x6210;&#x7684; &#x2192; &#x9032; <strong>static shell</strong>","children":[],"payload":{"tag":"li","lines":"21,22"}},{"content":"&#x4e0d;&#x80fd;&#x5b8c;&#x6210;&#x7684; &#x2192; &#x4f60;&#x5fc5;&#x9808;&#x660e;&#x78ba;&#x9078;&#x64c7;&#x600e;&#x9ebc;&#x8655;&#x7406;","children":[],"payload":{"tag":"li","lines":"22,24"}}],"payload":{"tag":"li","lines":"20,24"}}],"payload":{"tag":"h2","lines":"18,19"}},{"content":"3) &#x9047;&#x5230;&#x300c;&#x4e0d;&#x80fd; prerender&#x300d;&#x7684;&#x5167;&#x5bb9;&#xff1a;&#x4f60;&#x4e00;&#x5b9a;&#x8981;&#x505a; 2 &#x9078; 1","children":[{"content":"A) &#x7528; <code>&lt;Suspense&gt;</code> &#x5ef6;&#x5f8c;&#x5230; request time","children":[{"content":"<strong>fallback</strong> &#x6703;&#x9032; static shell","children":[],"payload":{"tag":"li","lines":"28,29"}},{"content":"&#x771f;&#x6b63;&#x5167;&#x5bb9;&#x5728; request time <strong>streaming</strong> &#x9032;&#x4f86;","children":[],"payload":{"tag":"li","lines":"29,30"}},{"content":"boundary &#x76e1;&#x91cf;&#x8cbc;&#x8fd1;&#x6162;&#x5143;&#x4ef6;&#xff08;&#x8b93; shell &#x6700;&#x5927;&#x5316;&#xff09;","children":[],"payload":{"tag":"li","lines":"30,32"}}],"payload":{"tag":"h3","lines":"27,28"}},{"content":"B) &#x7528; <code>&apos;use cache&apos;</code> &#x628a;&#x7d50;&#x679c;&#x5feb;&#x53d6;&#x9032; shell","children":[{"content":"&#x9069;&#x7528;&#xff1a;<strong>&#x4e0d;&#x4f9d;&#x8cf4; runtime data</strong>&#x3001;&#x8cc7;&#x6599;&#x4e0d;&#x9700;&#x6bcf;&#x6b21;&#x90fd;&#x6700;&#x65b0;","children":[],"payload":{"tag":"li","lines":"33,34"}},{"content":"&#x642d;&#x914d; <code>cacheLife()</code> &#x5b9a;&#x7fa9;&#x5feb;&#x53d6;&#x6642;&#x9593;","children":[],"payload":{"tag":"li","lines":"34,36"}}],"payload":{"tag":"h3","lines":"32,33"}}],"payload":{"tag":"h2","lines":"26,27"}},{"content":"4) &#x54ea;&#x4e9b;&#x6771;&#x897f;&#x300c;&#x4e00;&#x5b9a;&#x300d;&#x662f; request time&#xff08;&#x4e0d;&#x80fd; use cache&#xff09;","children":[{"content":"Runtime data&#xff08;&#x9700;&#x8981; request context&#xff09;","children":[{"content":"<code>cookies()</code>, <code>headers()</code>, <code>searchParams</code>, <code>params</code>&#xff08;&#x9664;&#x975e;&#x63d0;&#x4f9b; <code>generateStaticParams</code>&#xff09;","children":[],"payload":{"tag":"li","lines":"42,43"}},{"content":"&#x898f;&#x5247;&#xff1a;","children":[{"content":"&#x8b80; runtime APIs &#x7684;&#x5143;&#x4ef6; <strong>&#x5fc5;&#x9808;&#x5305;&#x5728; <code>&lt;Suspense&gt;</code></strong>","children":[],"payload":{"tag":"li","lines":"44,45"}},{"content":"runtime data <strong>&#x4e0d;&#x80fd;</strong> &#x8ddf; <code>&apos;use cache&apos;</code> &#x5728;&#x540c;&#x4e00; scope","children":[],"payload":{"tag":"li","lines":"45,47"}}],"payload":{"tag":"li","lines":"43,47"}}],"payload":{"tag":"h3","lines":"41,42"}}],"payload":{"tag":"h2","lines":"40,41"}},{"content":"5) &#x975e;&#x6c7a;&#x5b9a;&#x6027;&#x904b;&#x7b97;&#xff08;random / now / uuid&#xff09;","children":[{"content":"&#x60f3;&#x6bcf;&#x6b21; request &#x90fd;&#x4e0d;&#x540c;&#xff1a;","children":[{"content":"&#x5148; <code>await connection()</code>&#xff08;&#x660e;&#x78ba; defer&#xff09;&#x2192; &#x518d;&#x7b97; random/now/uuid &#x2192; &#x5305; <code>&lt;Suspense&gt;</code>","children":[],"payload":{"tag":"li","lines":"53,54"}}],"payload":{"tag":"li","lines":"52,54"}},{"content":"&#x60f3;&#x5927;&#x5bb6;&#x770b;&#x5230;&#x540c;&#x4e00;&#x4efd;&#xff08;&#x76f4;&#x5230; revalidate&#xff09;&#xff1a;","children":[{"content":"&#x653e;&#x9032; <code>&apos;use cache&apos;</code> scope","children":[],"payload":{"tag":"li","lines":"55,57"}}],"payload":{"tag":"li","lines":"54,57"}}],"payload":{"tag":"h2","lines":"51,52"}},{"content":"6) <code>&apos;use cache&apos;</code> &#x7684;&#x66f4;&#x65b0;&#x65b9;&#x5f0f;&#xff08;&#x8a18;&#x9019;&#x5169;&#x500b;&#x5c31;&#x597d;&#xff09;","children":[{"content":"&#x6642;&#x9593;&#x578b;&#xff1a;<code>cacheLife(&apos;hours&apos; | &apos;days&apos; | &apos;max&apos; | &#x81ea;&#x8a02;)</code>","children":[],"payload":{"tag":"li","lines":"60,61"}},{"content":"&#x4e8b;&#x4ef6;&#x578b;&#xff08;on-demand&#xff09;&#xff1a;","children":[{"content":"<code>cacheTag()</code> + <code>updateTag()</code>&#xff08;&#x7acb;&#x5373;&#x5237;&#x65b0;&#xff09;","children":[],"payload":{"tag":"li","lines":"62,63"}},{"content":"<code>cacheTag()</code> + <code>revalidateTag()</code>&#xff08;&#x53ef;&#x63a5;&#x53d7;&#x5ef6;&#x9072;&#x66f4;&#x65b0;&#xff09;","children":[],"payload":{"tag":"li","lines":"63,65"}}],"payload":{"tag":"li","lines":"61,65"}}],"payload":{"tag":"h2","lines":"59,60"}},{"content":"7) &#x555f;&#x7528;&#x5f8c;&#x5e38;&#x898b;&#x8a2d;&#x5b9a;&#x7684;&#x8b8a;&#x5316;&#xff08;&#x5feb;&#x901f;&#x8a18;&#xff09;","children":[{"content":"<code>revalidate</code> &#x2192; &#x7528; <code>cacheLife()</code> &#x53d6;&#x4ee3;","children":[],"payload":{"tag":"li","lines":"68,69"}},{"content":"<code>fetchCache</code> &#x2192; &#x4e0d;&#x9700;&#x8981;&#xff08;use cache scope &#x5167; fetch &#x81ea;&#x52d5;&#x5feb;&#x53d6;&#xff09;","children":[],"payload":{"tag":"li","lines":"69,70"}},{"content":"<code>dynamic=force-*</code> &#x2192; &#x591a;&#x6578;&#x60c5;&#x5883;&#x4e0d;&#x518d;&#x9700;&#x8981;&#xff08;&#x4f9d;&#x932f;&#x8aa4;&#x63d0;&#x793a;&#x6539;&#x7528; Suspense / use cache&#xff09;","children":[],"payload":{"tag":"li","lines":"70,71"}},{"content":"<code>runtime=&apos;edge&apos;</code> &#x2192; &#x274c; &#x4e0d;&#x652f;&#x63f4;&#xff08;Cache Components &#x9700;&#x8981; Node.js runtime&#xff09;","children":[],"payload":{"tag":"li","lines":"71,73"}}],"payload":{"tag":"h2","lines":"67,68"}},{"content":"8) &#x5c0e;&#x822a;&#x9ad4;&#x9a57;&#xff1a;<code>&lt;Activity&gt;</code>&#xff08;&#x77e5;&#x9053;&#x6982;&#x5ff5;&#x5373;&#x53ef;&#xff09;","children":[{"content":"client-side navigation &#x6642;&#xff0c;&#x820a;&#x9801;&#x9762;&#x53ef;&#x80fd;&#x5148;&#x8b8a; <code>hidden</code> &#x800c;&#x975e; unmount","children":[],"payload":{"tag":"li","lines":"76,77"}},{"content":"&#x597d;&#x8655;&#xff1a;&#x8fd4;&#x56de;&#x4e0a;&#x4e00;&#x9801;&#x6642; <strong>&#x72c0;&#x614b;&#x4fdd;&#x7559;</strong>&#xff08;&#x8868;&#x55ae;&#x3001;&#x5c55;&#x958b;&#x5340;&#x584a;&#xff09;","children":[],"payload":{"tag":"li","lines":"77,79"}}],"payload":{"tag":"h2","lines":"75,76"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
